/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    // Required by axion-release
    id 'org.ajoberstar.grgit'
    // Git based versioning
    id 'pl.allegro.tech.build.axion-release'
}

def shortened = project.name.startsWith(project.group + ".") ?
    project.name.substring(project.group.length() + 1) : project.name
if (shortened == "manager") {
    shortened = "manager-app";
}
var tagName = shortened.replace('.', '-') + "-"
if (grgit.branch.current.name != "main"
    && grgit.branch.current.name != "HEAD"
    && !grgit.branch.current.name.startsWith("release")
    && !grgit.branch.current.name.startsWith("develop")) {
    tagName = tagName + grgit.branch.current.name.replace('/', '-') + "-"
}
project.ext.tagName = tagName

scmVersion {
    versionIncrementer 'incrementMinor'
    tag {
        prefix = project.tagName
    }
}
project.version = scmVersion.version
ext.isSnapshot = version.endsWith('-SNAPSHOT')
